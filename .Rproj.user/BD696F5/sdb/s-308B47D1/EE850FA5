{
    "contents" : "library(XML)\n#Read the file\n\ncreate_cell<-function(nodeName,node){\n  if(length(node)==0 )\n  {\n    assign(nodeName,NA,envir = .GlobalEnv)\n  }else{\n    assign(xmlName(node[[1]]),xmlValue(node[[1]]),envir = .GlobalEnv)\n  }\n  \n}\n\ntemp<-NULL\ntemp1<-NULL\n\ncreate_observation<-function(file)\n{\nxmlDoc<-xmlTreeParse(file)\nxmltop<<-xmlRoot(xmlDoc)\n#get the node\n\ngetNodeAndCreateCell<-function(node){\n  if(node %in% names(other_tables))\n  {\n    table_name<-node\n    \n    nodeAddress<-paste(\"//\",node,sep=\"\")\n    subnode<<-getNodeSet(xmltop,nodeAddress)\n    \n    xmlSubNodes<-other_tables[[node]]\n    counter=0\n#     if(length(subnode)==8)\n#     {\n#       print(subnode)\n#       x<<-subnode\n    \n    #print(length(subnode))\n    for(node in subnode){\n      # print(node)\n      counter=counter+1\n    sub_node<<-node\n    \n    for (node in xmlSubNodes){\n      nodeName<-node\n      nodeAddress<-paste(\"//\",node,sep=\"\")\n      node<-getNodeSet(sub_node,nodeAddress)\n      if(nodeName=='time_frame')\n      {print(node)}\n      if(nodeName!='nct_id')\n      create_cell(nodeName,node)\n      \n    }\n    if(counter==1){\n    xmlSubNodes<-append(\"nct_id\",xmlSubNodes)\n    }\n    char_vect<-sapply(xmlSubNodes,function(x)eval(parse(text=x)))\n    assign(table_name,data.frame(as.list(char_vect)),envir = .GlobalEnv)\n    \n    #print(primary_outcome)\n    temp1<<-rbind(temp1,primary_outcome)\n    }\n  }else{\n  nodeName<-node\n  nodeAddress<-paste(\"//\",node,sep=\"\")\n  node<-getNodeSet(xmltop,nodeAddress)\n  create_cell(nodeName,node)\n  }\n}\n\n\noutcome_struct<-c(\"measure\",\"time_frame\",\"safety_issue\",\"description\")\n\nother_tables<-list(primary_outcome=outcome_struct)\n\nxmlNodes<-c(\"nct_id\",\"brief_title\",\"acronym\",\"official_title\",\"source\",\"brief_summary/textblock\",\"detailed_description/textblock\",\"overall_status\",\"start_date\",\"completion_date\",\"primary_completion_date\",\"phase\",\"study_type\",\"study_design\",\"target_duration\",\"number_of_arms\",\"number_of_groups\",\"primary_outcome\")\n#xmlNodes<-c(\"primary_outcome\")\n\nsapply(xmlNodes,function(node) getNodeAndCreateCell(node))\n\nobservation<<-data.frame(nct_id,brief_title,acronym,official_title,source,textblock,textblock,overall_status,start_date,completion_date,primary_completion_date,phase,study_type,study_design,target_duration,number_of_arms,number_of_groups,stringsAsFactors = FALSE)\nnames(observation)[6]<-\"brief_summary\"\nnames(observation)[7]<-\"det-description\"\ntemp<<-rbind(temp,observation)\n}\n\nfiles<-dir()\nsapply(files,function(file) create_observation(file))\nobservation<-temp\n",
    "created" : 1440861604582.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1646232068",
    "id" : "EE850FA5",
    "lastKnownWriteTime" : 1440872035,
    "path" : "C:/Users/shany_000/Desktop/clinical_trials_R/xmlparse2.R",
    "project_path" : "xmlparse2.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}